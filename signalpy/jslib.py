data = 'function SignalPy(url,secure){\n    if (secure === undefined) {\n    secure = \'://\';\n    } \n    if (secure === true) {\n    secure = \'s://\';\n    } \n    if (secure === undefined) {\n    secure = \'://\';\n    }\n    if (\'WebSocket\' in window){\n        url=\'ws\'+secure+url;\n        w = new WebSocket(url);\n        return w;\n    }\n    else{\n        url=\'http\'+secure+url;\n        obj = new signalpyajax();\n        obj.url=url;\n        obj.receive();\n        return obj;\n    }\n}\nsignalpyajax={\n    id:"",\n    url:"",\n    onopen:function(){\n        this.state=\'open\'\n    },\n    onerror:function(obj){},\n    onmessage:function(msg){},\n    _open:function(msg){\n        if(this.id===\'\'){\n            this.id=msg;this.onopen()\n        }else{\n            arr=JSON.parse(msg)\n            for(message in arr){\n                this.onmessage({data:message})\n            }\n        }\n        this.receive();\n    },\n    receive:function () {\n    _this=this;\n    var request = this.return_ajax();\n    request.open(\'POST\',this.url+\'?id=\'+this.id);\n    request.onreadystatechange = function() {\n        if (this.readyState == 4 && this.status == 200) {\n            _this._open(this.responseText)\n        }\n    };\n    request.onerror = function() {\n        _this.onerror({})\n    };\n    request.send();\n},\n    send:function (msg) {\n    _this=this;\n    var request = this.return_ajax()\n    request.open(\'POST\',this.url+this.id);\n    request.onerror = function() {\n        _this.onerror({message:msg})\n    };\n    request.send(msg);\n},\n\n    return_ajax:function (){\n    try{\n        // Opera 8.0+, Firefox, Safari (1st attempt)\n        xhttp = new XMLHttpRequest();\n        return xhttp;\n    }catch (e){\n        // IE browser (2nd attempt)\n        try{\n            xhttp = new ActiveXObject("Msxml2.XMLHTTP");\n            return xhttp;\n        }catch (e) {\n            try{\n                // 3rd attempt\n                xhttp = new ActiveXObject("Microsoft.XMLHTTP");\n                return xhttp;\n            }catch (e){\n                return false;\n        }\n    }\n}\n    }}\n'
